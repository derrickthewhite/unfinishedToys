<html>
	<!--- based on the rules given at https://kevan.org/games/technopoly.php --->
	<head>
		<title>Techopoloy</title>
		<link href="main.css" rel="stylesheet">
		<script type="text/javascript" src= "../../Tools/knockout-3.4.0.js"></script>
		<script type="text/javascript" src= "tools.js"></script>
		<script type="text/javascript" src= "cards.js"></script>
		<script type="text/javascript" src= "construction.js"></script>
		<script type="text/javascript" src= "player.js"></script>
		<script type="text/javascript" src= "model.js"></script>
		<script type="text/javascript" src= "game.js"></script>
		<script>
			
			var game = Game();
			function load()
			{	
				ko.applyBindings(game,document.getElementById('main'));
			}
		</script>
	</head>
	<body onload="load()">
		<div id="main">
			<!-- ko if:game.model.mode()=='setup' -->
				New Player Name <input type = "text" data-bind="value:newPlayerName"></input> <br>
				<button data-bind="click:addPlayer"> Add Player</button> <br>
				<button data-bind="click:startGame"> Start Game </button> <br>
				
				<div data-bind="foreach:model.players">
					<div data-bind="text:name"></div>
				</div>
			<!-- /ko -->
			<!-- ko if:game.model.mode()!='setup' -->
				<h1>Current Player: <span data-bind="text:currentPlayer().name"></span></h1> <br>
			<!-- /ko -->
			<!-- ko if:game.model.mode()=='mainView' -->
				<button data-bind="click:nextTurn"> End Turn</button> <br>
			<!-- /ko -->
			<!-- ko if:game.model.mode()=='invention' -->
			
				<h2>Active Player: <span data-bind="text:model.cardActivePlayer().name"></span></h2> <br>
				<h3>Phase: <span data-bind="text:game.model.mode()"></span></h3> <br>
				Invention Name <input type = "text" data-bind="value:inventionName"></input> <br>
				Next Card: <select data-bind=
					"value:cardForInvention,
					options:model.cardActivePlayer().cards,
					optionsText:'name'"
					></select>
				Fuel: <select data-bind="value:fuelToUse,options:possibleFuels"></select>

				<button data-bind="click:addCard"> Add Card</button><br>
				<button data-bind="click:declineToAdd"> No Action</button><br>
				<!-- ko if: (model.cardActivePlayer()==game.currentPlayer()) -->
					<button data-bind="click:finalizeInvention"> Finalize Invention</button> <br>
					<button data-bind="click:skipInventing"> Skip Inventing</button> <br>
				<!-- /ko -->
				<div data-bind="if:cardForInvention"><span data-bind="text:cardForInvention().name"></span></div>
				Cards On Table <br>
				<div data-bind="foreach:model.cardsSelected" class="section">
					<span data-bind="text:name"></span><br>
				</div>
			<!-- /ko -->
			<div data-bind="foreach:model.players">
				<h5><div data-bind="text:name"></div></h5>
				<span data-bind="text:score"></span><br>
				Deck <br>
				<div data-bind="foreach:cards" class="section">
					<div data-bind="text:name"></div>
				</div>
				<div data-bind="foreach:constructions">
					<span data-bind="text:type.name"></span>:
					<span data-bind="text:number"></span>
					<!-- ko if:game.model.mode()=='mainView' && game.currentPlayer().id==$parent.id -->
						toBuild: <input type="number" data-bind="value:game.activeConstructionsMap()[$data.type.id].toBuild">
						
						<span data-bind="text:type.useName"></span> :
						<input type="number" data-bind="value:game.activeConstructionsMap()[$data.type.id].toActivate"></input>
						<span data-bind="foreach:game.activeConstructionsMap()[$data.type.id].cost" class="costs">
							<span data-bind="text:resource"></span>:
							<span data-bind="text:value"></span>
						</span>
						<span data-bind="foreach:game.activeConstructionsMap()[$data.type.id].output" class="outputs">
							<span data-bind="text:resource"></span>:
							<span data-bind="text:value"></span>
						</span>
					<!-- /ko -->
					<br>
				</div>
				<!-- ko if: id == game.currentPlayer().id -->
					Manipulators Anassigned: <span data-bind="text:game.manipulatorsLeft"></span>
					<!-- ko foreach:game.statics.manipUses -->
					<span data-bind="text:capitalize($data)"></span>:
					<input type="number" data-bind="value:game[$data]" ></input>
					<!-- /ko -->
					
					<div data-bind="foreach:game.currentPlayer().constructions">
						<div class = "section">
							name: <span data-bind="text:name"></span>
							<div data-bind="foreach:type.effects">
								<div data-bind="text:name"></div>
							</div>
						</div>
					</div>
				<!-- /ko -->
			</div>
			<div data-bind="foreach:errors" class = "errors">
				<span data-bind="text:$data"></span><br>
			</div>
			<div data-bind="foreach:warnings" class = "warnings">
				<span data-bind="text:$data"></span><br>
			</div>

		</div>
	</body>
<html>