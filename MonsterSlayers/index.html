<html>
	<head>
		<title>Monster Slayers</title>
		<link href="main.css" rel="stylesheet">
		<script type="text/javascript" src= "../../Tools/knockout-3.4.0.js"></script>
		<script src = "https://cdnjs.cloudflare.com/ajax/libs/konva/1.6.8/konva.min.js"></script>
		<script src = "konva-knockout.js"></script>
		<script type="text/javascript" src= "tools.js"></script>
		<script type="text/javascript" src= "unit.js"></script>
		<script type="text/javascript" src= "battlefield.js"></script>
		<script type="text/javascript" src= "main.js"></script>
		<script>
		</script>
	</head>
	<body onload="load()">
		<div id="main">
			<table>
				<tbody>
					<tr>
						<th>Name</th>
						<th>Type</th>
						<th>HP</th>
						<th>Wounds</th>
						<th>Status</th>
					</tr>
					<!-- ko foreach:team -->
						<tr data-bind="css: {selected: $parent.selected() == $data}">
						<th data-bind = "text:name"></td>
						<td data-bind = "text:type"></td>
						<td data-bind = "text:hitPoints"></td>
						<td data-bind = "text:wounds"></td>
						<td data-bind = "text:conditions"></td>
						<td data-bind = "text:status"></td>
						<td data-bind = "text:turnStatus"></td>
						<td data-bind = "text:activeWeapon().name"></td>
						<td data-bind = "text:weaponStatus"></td>
						<!-- ko if:$parent.activeSide() == "team" -->
							<td><button data-bind="click:$parent.select">select</button></td>
						<!-- /ko -->
					</tr>
					<!-- /ko -->
				</tbody>
			</table>
			<table>
				<tbody>
					<tr>
						<th>Name</th>
						<th>Type</th>
						<th>HP</th>
						<th>Wounds</th>
						<th>Status</th>
					</tr>
					<!-- ko foreach:targets -->
					<tr data-bind="css: {selected: $parent.selected() == $data}">
						<th data-bind = "text:name"></td>
						<td data-bind = "text:type"></td>
						<td data-bind = "text:hitPoints"></td>
						<td data-bind = "text:wounds"></td>
						<td data-bind = "text:conditions"></td>
						<td data-bind = "text:status"></td>
						<td data-bind = "text:turnStatus"></td>
						<td data-bind = "text:activeWeapon().name"></td>
						<td data-bind = "text:weaponStatus"></td>
						<!-- ko if:$parent.activeSide() == "targets" -->
							<td><button data-bind="click:$parent.select">select</button></td>
						<!-- /ko -->
					</tr>
					<!-- /ko -->
				</tbody>
			</table>
			<div data-bind="if: selected()">
				<div data-bind="foreach: currentValidActions">
					<button data-bind="text:name , click: action"></button>
				</div>
			</div>
			<div data-bind="text:narration"></div>
			<button data-bind="click:nextTurn">Next Turn</button>
			<!-- ko Konva.Stage: { width: 500, height: 500 } -->
				<!-- ko Konva.Layer: { } -->
					<!-- ko Konva.Rect: { x: 0, y: 0, width: 500, height: 500, fill: "teal", stroke: "black", strokeWidth: 2, click:$root.battleFeild.locationClick, data:$data} -->
					<!-- /ko -->
				<!-- /ko -->
				<!-- ko Konva.Layer: { } -->
					<!-- ko with: game.selected -->
						<!-- ko Konva.Circle: { x: battlefieldPosition.x()*20, y: battlefieldPosition.y()*20, radius: activeWeapon().reach*20 , stroke: "black", strokeWidth:1, fill: "red", opacity:.25 } -->
						<!-- /ko -->
						<!-- ko Konva.Rect: { x: battlefieldPosition.x()*20-15, y: battlefieldPosition.y()*20-15, width: 30, height: 30, fill: "#ffffff",} -->
						<!-- /ko -->
					<!-- /ko -->
					<!-- ko foreach:validMovePositions -->
						<!-- ko Konva.Circle: { x:x*20, y: y*20, radius: 5 , stroke: "black", strokeWidth:1, fill: "#ffffff", click:$root.battleFeild.moveCircleClick, data:$data} -->
						<!-- /ko -->
					<!-- /ko -->
				<!-- /ko -->

				<!-- ko Konva.Layer: { } -->
					<!-- ko foreach: game.team -->
						<!-- TODO: leave corpses! -->
						<!-- ko ifnot:isProne -->
							<!-- ko Konva.Rect: { x: battlefieldPosition.x()*20-10, y: battlefieldPosition.y()*20-10, width: 20, height: 20, fill: "#ff0000", stroke: "black", strokeWidth: 2, click:$root.battleFeild.objectClick, data:$data} -->
							<!-- /ko -->
						<!-- /ko -->
					<!-- /ko -->
					<!-- ko foreach: game.targets -->
						<!-- ko Konva.Rect: { x: battlefieldPosition.x()*20-10, y: battlefieldPosition.y()*20-10, width: 20, height: 20, fill: "#0000ff", stroke: "black", strokeWidth: 2, click:$root.battleFeild.objectClick, data:$data} -->
						<!-- /ko -->
					<!-- /ko -->
				<!-- /ko -->
			<!-- /ko -->
		</div>
	</body>
<html>